import React, { useState } from "react";
import { Link, useLocation } from "react-router-dom";
import { useAuth } from "../../../Auth/AuthContext"; 
import "./style/Sidebar.css";

const Sidebar = ({ isOpen, setIsSidebarOpen }) => {
  const location = useLocation();
  const { logout, isAdmin } = useAuth();
  const [showLogoutModal, setShowLogoutModal] = useState(false);

  const isActive = (path) => {
    if (path === "/dashboard" && location.pathname === "/dashboard") {
      return true;
    }
    return location.pathname === path;
  };

  const handleLogout = () => {
    setShowLogoutModal(true);
  };

  const confirmLogout = () => {
    logout();
    setShowLogoutModal(false);
  };

  return (
    <>
      <div className={`sidebar ${isOpen ? "show" : ""}`}>
        <div className="sidebar-header d-flex align-items-center">
          <button
            className="btn close-btn me-2 d-lg-none"
            onClick={() => setIsSidebarOpen(false)}
          >
             <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
            >
              <path
                d="M18 6L6 18M6 6l12 12"
                stroke="white"
                strokeWidth="3"
                strokeLinecap="round"
              />
            </svg>
          </button>
          <h3 className="text-center mb-0">BudgetBuddy</h3>
        </div>

        <nav className="sidebar-nav">
          <Link
            to="/dashboard"
            className={`nav-link ${isActive("/dashboard") ? "active" : ""}`}
          >
  <svg
              className="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M9.75 3.75H5.25C4.85218 3.75 4.47064 3.90804 4.18934 4.18934C3.90804 4.47064 3.75 4.85218 3.75 5.25V9.75C3.75 10.1478 3.90804 10.5294 4.18934 10.8107C4.47064 11.092 4.85218 11.25 5.25 11.25H9.75C10.1478 11.25 10.5294 11.092 10.8107 10.8107C11.092 10.5294 11.25 10.1478 11.25 9.75V5.25C11.25 4.85218 11.092 4.47064 10.8107 4.18934C10.5294 3.90804 10.1478 3.75 9.75 3.75ZM9.75 9.75H5.25V5.25H9.75V9.75ZM18.75 3.75H14.25C13.8522 3.75 13.4706 3.90804 13.1893 4.18934C12.908 4.47064 12.75 4.85218 12.75 5.25V9.75C12.75 10.1478 12.908 10.5294 13.1893 10.8107C13.4706 11.092 13.8522 11.25 14.25 11.25H18.75C19.1478 11.25 19.5294 11.092 19.8107 10.8107C20.092 10.5294 20.25 10.1478 20.25 9.75V5.25C20.25 4.85218 20.092 4.47064 19.8107 4.18934C19.5294 3.90804 19.1478 3.75 18.75 3.75ZM18.75 9.75H14.25V5.25H18.75V9.75ZM9.75 12.75H5.25C4.85218 12.75 4.47064 12.908 4.18934 13.1893C3.90804 13.4706 3.75 13.8522 3.75 14.25V18.75C3.75 19.1478 3.90804 19.5294 4.18934 19.8107C4.47064 20.092 4.85218 20.25 5.25 20.25H9.75C10.1478 20.25 10.5294 20.092 10.8107 19.8107C11.092 19.5294 11.25 19.1478 11.25 18.75V14.25C11.25 13.8522 11.092 13.4706 10.8107 13.1893C10.5294 12.908 10.1478 12.75 9.75 12.75ZM9.75 18.75H5.25V14.25H9.75V18.75ZM18.75 12.75H14.25C13.8522 12.75 13.4706 12.908 13.1893 13.1893C12.908 13.4706 12.75 13.8522 12.75 14.25V18.75C12.75 19.1478 12.908 19.5294 13.1893 19.8107C13.4706 20.092 13.8522 20.25 14.25 20.25H18.75C19.1478 20.25 19.5294 20.092 19.8107 19.8107C20.092 19.5294 20.25 19.1478 20.25 18.75V14.25C20.25 13.8522 20.092 13.4706 19.8107 13.1893C19.5294 12.908 19.1478 12.75 18.75 12.75ZM18.75 18.75H14.25V14.25H18.75V18.75Z"
                fill="white"
              />
            </svg>
                        <span>Dashboard</span>
          </Link>

          <Link
            to="/dashboard/budgets"
            className={`nav-link ${
              isActive("/dashboard/budgets") ? "active" : ""
            }`}
          >
<svg
              className="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M18 10.875C18 11.0975 17.934 11.315 17.8104 11.5C17.6868 11.685 17.5111 11.8292 17.3055 11.9144C17.1 11.9995 16.8738 12.0218 16.6555 11.9784C16.4373 11.935 16.2368 11.8278 16.0795 11.6705C15.9222 11.5132 15.815 11.3127 15.7716 11.0945C15.7282 10.8762 15.7505 10.65 15.8356 10.4445C15.9208 10.2389 16.065 10.0632 16.25 9.9396C16.435 9.81598 16.6525 9.75 16.875 9.75C17.1734 9.75 17.4595 9.86853 17.6705 10.0795C17.8815 10.2905 18 10.5766 18 10.875ZM14.25 6H10.5C10.3011 6 10.1103 6.07902 9.96967 6.21967C9.82902 6.36032 9.75 6.55109 9.75 6.75C9.75 6.94891 9.82902 7.13968 9.96967 7.28033C10.1103 7.42098 10.3011 7.5 10.5 7.5H14.25C14.4489 7.5 14.6397 7.42098 14.7803 7.28033C14.921 7.13968 15 6.94891 15 6.75C15 6.55109 14.921 6.36032 14.7803 6.21967C14.6397 6.07902 14.4489 6 14.25 6ZM23.25 10.5V13.5C23.25 14.0967 23.0129 14.669 22.591 15.091C22.169 15.5129 21.5967 15.75 21 15.75H20.7788L19.2591 20.0044C19.155 20.2958 18.9634 20.5479 18.7105 20.7261C18.4575 20.9044 18.1557 21 17.8463 21H16.6538C16.3443 21 16.0425 20.9044 15.7895 20.7261C15.5366 20.5479 15.345 20.2958 15.2409 20.0044L15.0609 19.5H9.68906L9.50906 20.0044C9.40502 20.2958 9.2134 20.5479 8.96047 20.7261C8.70754 20.9044 8.40568 21 8.09625 21H6.90375C6.59433 21 6.29246 20.9044 6.03953 20.7261C5.7866 20.5479 5.59498 20.2958 5.49094 20.0044L4.3125 16.7081C3.19142 15.4393 2.48945 13.8553 2.3025 12.1725C2.06046 12.2996 1.85777 12.4905 1.71633 12.7245C1.57489 12.9584 1.50009 13.2266 1.5 13.5C1.5 13.6989 1.42098 13.8897 1.28033 14.0303C1.13968 14.171 0.948912 14.25 0.75 14.25C0.551088 14.25 0.360322 14.171 0.21967 14.0303C0.0790176 13.8897 0 13.6989 0 13.5C0.00114598 12.8312 0.225771 12.1819 0.638188 11.6553C1.05061 11.1287 1.62716 10.7551 2.27625 10.5938C2.4438 8.52687 3.38252 6.59859 4.90601 5.1918C6.42951 3.78502 8.42634 3.00263 10.5 3H20.25C20.4489 3 20.6397 3.07902 20.7803 3.21967C20.921 3.36032 21 3.55109 21 3.75C21 3.94891 20.921 4.13968 20.7803 4.28033C20.6397 4.42098 20.4489 4.5 20.25 4.5H18.2447C19.4894 5.37328 20.4683 6.57378 21.0731 7.96875C21.1134 8.0625 21.1528 8.15625 21.1903 8.25C21.7535 8.2978 22.278 8.5558 22.6596 8.97268C23.0413 9.38957 23.252 9.93482 23.25 10.5ZM21.75 10.5C21.75 10.3011 21.671 10.1103 21.5303 9.96967C21.3897 9.82902 21.1989 9.75 21 9.75H20.6569C20.4971 9.75017 20.3415 9.69934 20.2127 9.6049C20.0839 9.51047 19.9885 9.37738 19.9406 9.225C19.5109 7.85375 18.6542 6.65571 17.4956 5.8057C16.337 4.95569 14.937 4.49821 13.5 4.5H10.5C9.19005 4.49993 7.90838 4.88103 6.81128 5.59682C5.71419 6.31261 4.84907 7.33217 4.32143 8.53115C3.79379 9.73014 3.62643 11.0568 3.83975 12.3492C4.05308 13.6417 4.63787 14.8442 5.52281 15.81C5.59048 15.8836 5.64276 15.97 5.67656 16.0641L6.90375 19.5H8.09625L8.45438 18.4978C8.50637 18.3522 8.60211 18.2262 8.72848 18.1371C8.85485 18.048 9.00568 18.0001 9.16031 18H15.5897C15.7443 18.0001 15.8951 18.048 16.0215 18.1371C16.1479 18.2262 16.2436 18.3522 16.2956 18.4978L16.6538 19.5H17.8463L19.5441 14.7478C19.5961 14.6022 19.6918 14.4762 19.8182 14.3871C19.9445 14.298 20.0954 14.2501 20.25 14.25H21C21.1989 14.25 21.3897 14.171 21.5303 14.0303C21.671 13.8897 21.75 13.6989 21.75 13.5V10.5Z"
                fill="white"
              />
            </svg>            <span>Budgets</span>
          </Link>

          <Link
            to="/dashboard/recurring-expenses"
            className={`nav-link ${
              isActive("/dashboard/recurring-expenses") ? "active" : ""
            }`}
          >
<svg
              className="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M17.25 8.39719V7.875C17.25 5.52375 13.7034 3.75 9 3.75C4.29656 3.75 0.75 5.52375 0.75 7.875V11.625C0.75 13.5834 3.21094 15.1397 6.75 15.6056V16.125C6.75 18.4762 10.2966 20.25 15 20.25C19.7034 20.25 23.25 18.4762 23.25 16.125V12.375C23.25 10.4344 20.8669 8.87625 17.25 8.39719ZM21.75 12.375C21.75 13.6144 18.8634 15 15 15C14.6503 15 14.3034 14.9878 13.9613 14.9653C15.9834 14.2284 17.25 13.0312 17.25 11.625V9.91313C20.0503 10.3303 21.75 11.4628 21.75 12.375ZM6.75 14.0859V11.8556C7.49604 11.9528 8.24765 12.0011 9 12C9.75235 12.0011 10.504 11.9528 11.25 11.8556V14.0859C10.5051 14.196 9.75302 14.2508 9 14.25C8.24698 14.2508 7.49493 14.196 6.75 14.0859ZM15.75 10.3059V11.625C15.75 12.4116 14.5866 13.2562 12.75 13.7691V11.5781C13.9603 11.2847 14.985 10.8478 15.75 10.3059ZM9 5.25C12.8634 5.25 15.75 6.63562 15.75 7.875C15.75 9.11438 12.8634 10.5 9 10.5C5.13656 10.5 2.25 9.11438 2.25 7.875C2.25 6.63562 5.13656 5.25 9 5.25ZM2.25 11.625V10.3059C3.015 10.8478 4.03969 11.2847 5.25 11.5781V13.7691C3.41344 13.2562 2.25 12.4116 2.25 11.625ZM8.25 16.125V15.7341C8.49656 15.7434 8.74594 15.75 9 15.75C9.36375 15.75 9.71906 15.7378 10.0678 15.7172C10.4552 15.8559 10.8499 15.9736 11.25 16.0697V18.2691C9.41344 17.7562 8.25 16.9116 8.25 16.125ZM12.75 18.5859V16.35C13.4958 16.4503 14.2475 16.5004 15 16.5C15.7523 16.5011 16.504 16.4528 17.25 16.3556V18.5859C15.758 18.8047 14.242 18.8047 12.75 18.5859ZM18.75 18.2691V16.0781C19.9603 15.7847 20.985 15.3478 21.75 14.8059V16.125C21.75 16.9116 20.5866 17.7562 18.75 18.2691Z"
                fill="white"
              />
            </svg>            <span>Recurring Expenses</span>
          </Link>

          <div className="divider"></div>

          {isAdmin() && (
            <Link
              to="/dashboard/department"
              className={`nav-link ${
                isActive("/dashboard/department") ? "active" : ""
              }`}
            >
<svg className="svg-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path d="M2.55 11.8499C2.62879 11.909 2.71845 11.952 2.81386 11.9764C2.90927 12.0009 3.00856 12.0063 3.10607 11.9924C3.20357 11.9784 3.29737 11.9454 3.38212 11.8953C3.46687 11.8451 3.54091 11.7787 3.6 11.6999C4.05409 11.0944 4.64291 10.603 5.31983 10.2646C5.99675 9.9261 6.74318 9.7499 7.5 9.7499C8.25682 9.7499 9.00325 9.9261 9.68017 10.2646C10.3571 10.603 10.9459 11.0944 11.4 11.6999C11.5195 11.8589 11.6972 11.9639 11.8941 11.9918C12.091 12.0198 12.291 11.9684 12.45 11.849C12.5067 11.8068 12.5569 11.7566 12.5991 11.6999C13.0532 11.0944 13.642 10.603 14.3189 10.2646C14.9958 9.9261 15.7422 9.7499 16.4991 9.7499C17.2559 9.7499 18.0023 9.9261 18.6792 10.2646C19.3561 10.603 19.945 11.0944 20.3991 11.6999C20.5185 11.859 20.6963 11.9642 20.8933 11.9922C21.0903 12.0203 21.2904 11.9689 21.4495 11.8494C21.6087 11.73 21.7138 11.5522 21.7419 11.3552C21.7699 11.1582 21.7185 10.9581 21.5991 10.799C20.9352 9.90896 20.0499 9.20823 19.0312 8.76646C19.5897 8.25659 19.981 7.58979 20.1537 6.85358C20.3264 6.11737 20.2725 5.34614 19.9991 4.6411C19.7256 3.93607 19.2454 3.33017 18.6215 2.90293C17.9976 2.47569 17.259 2.24707 16.5028 2.24707C15.7466 2.24707 15.0081 2.47569 14.3841 2.90293C13.7602 3.33017 13.28 3.93607 13.0066 4.6411C12.7331 5.34614 12.6792 6.11737 12.8519 6.85358C13.0247 7.58979 13.4159 8.25659 13.9744 8.76646C13.2389 9.0845 12.5707 9.53981 12.0056 10.108C11.4406 9.53981 10.7724 9.0845 10.0369 8.76646C10.5953 8.25659 10.9866 7.58979 11.1593 6.85358C11.332 6.11737 11.2781 5.34614 11.0047 4.6411C10.7313 3.93607 10.2511 3.33017 9.62712 2.90293C9.00317 2.47569 8.26464 2.24707 7.50844 2.24707C6.75224 2.24707 6.0137 2.47569 5.38976 2.90293C4.76581 3.33017 4.28561 3.93607 4.01218 4.6411C3.73874 5.34614 3.68484 6.11737 3.85756 6.85358C4.03028 7.58979 4.42154 8.25659 4.98 8.76646C3.95686 9.2068 3.06722 9.90797 2.4 10.7999C2.34091 10.8787 2.29791 10.9683 2.27346 11.0638C2.24902 11.1592 2.24361 11.2585 2.25754 11.356C2.27147 11.4535 2.30446 11.5473 2.35464 11.632C2.40483 11.7168 2.47121 11.7908 2.55 11.8499ZM16.5 3.74989C16.945 3.74989 17.38 3.88186 17.75 4.12909C18.12 4.37632 18.4084 4.72772 18.5787 5.13886C18.749 5.54999 18.7936 6.00239 18.7068 6.43885C18.62 6.87531 18.4057 7.27622 18.091 7.59089C17.7763 7.90555 17.3754 8.11985 16.939 8.20666C16.5025 8.29348 16.0501 8.24892 15.639 8.07862C15.2278 7.90833 14.8764 7.61994 14.6292 7.24993C14.382 6.87992 14.25 6.4449 14.25 5.99989C14.25 5.40316 14.4871 4.83086 14.909 4.4089C15.331 3.98695 15.9033 3.74989 16.5 3.74989ZM7.5 3.74989C7.94501 3.74989 8.38002 3.88186 8.75003 4.12909C9.12004 4.37632 9.40843 4.72772 9.57873 5.13886C9.74903 5.54999 9.79358 6.00239 9.70677 6.43885C9.61995 6.87531 9.40566 7.27622 9.09099 7.59089C8.77632 7.90555 8.37541 8.11985 7.93895 8.20666C7.5025 8.29348 7.0501 8.24892 6.63896 8.07862C6.22783 7.90833 5.87643 7.61994 5.62919 7.24993C5.38196 6.87992 5.25 6.4449 5.25 5.99989C5.25 5.40316 5.48705 4.83086 5.90901 4.4089C6.33097 3.98695 6.90326 3.74989 7.5 3.74989ZM19.0312 18.5165C19.5897 18.0066 19.981 17.3398 20.1537 16.6036C20.3264 15.8674 20.2725 15.0961 19.9991 14.3911C19.7256 13.6861 19.2454 13.0802 18.6215 12.6529C17.9976 12.2257 17.259 11.9971 16.5028 11.9971C15.7466 11.9971 15.0081 12.2257 14.3841 12.6529C13.7602 13.0802 13.28 13.6861 13.0066 14.3911C12.7331 15.0961 12.6792 15.8674 12.8519 16.6036C13.0247 17.3398 13.4159 18.0066 13.9744 18.5165C13.2389 18.8345 12.5707 19.2898 12.0056 19.858C11.4406 19.2898 10.7724 18.8345 10.0369 18.5165C10.5953 18.0066 10.9866 17.3398 11.1593 16.6036C11.332 15.8674 11.2781 15.0961 11.0047 14.3911C10.7313 13.6861 10.2511 13.0802 9.62712 12.6529C9.00317 12.2257 8.26464 11.9971 7.50844 11.9971C6.75224 11.9971 6.0137 12.2257 5.38976 12.6529C4.76581 13.0802 4.28561 13.6861 4.01218 14.3911C3.73874 15.0961 3.68484 15.8674 3.85756 16.6036C4.03028 17.3398 4.42154 18.0066 4.98 18.5165C3.95686 18.9568 3.06722 19.658 2.4 20.5499C2.34091 20.6287 2.29791 20.7183 2.27346 20.8138C2.24902 20.9092 2.24361 21.0085 2.25754 21.106C2.27147 21.2035 2.30446 21.2973 2.35464 21.382C2.40483 21.4668 2.47121 21.5408 2.55 21.5999C2.62879 21.659 2.71845 21.702 2.81386 21.7264C2.90927 21.7509 3.00856 21.7563 3.10607 21.7424C3.20357 21.7284 3.29737 21.6954 3.38212 21.6452C3.46687 21.5951 3.54091 21.5287 3.6 21.4499C4.05409 20.8444 4.64291 20.353 5.31983 20.0146C5.99675 19.6761 6.74318 19.4999 7.5 19.4999C8.25682 19.4999 9.00325 19.6761 9.68017 20.0146C10.3571 20.353 10.9459 20.8444 11.4 21.4499C11.5195 21.6089 11.6972 21.7139 11.8941 21.7418C12.091 21.7698 12.291 21.7184 12.45 21.599C12.5067 21.5568 12.5569 21.5066 12.5991 21.4499C13.0532 20.8444 13.642 20.353 14.3189 20.0146C14.9958 19.6761 15.7422 19.4999 16.4991 19.4999C17.2559 19.4999 18.0023 19.6761 18.6792 20.0146C19.3561 20.353 19.945 20.8444 20.3991 21.4499C20.5185 21.609 20.6963 21.7142 20.8933 21.7422C21.0903 21.7703 21.2904 21.7189 21.4495 21.5994C21.6087 21.48 21.7138 21.3022 21.7419 21.1052C21.7699 20.9082 21.7185 20.7081 21.5991 20.549C20.9352 19.659 20.0499 18.9582 19.0312 18.5165ZM7.5 13.4999C7.94501 13.4999 8.38002 13.6319 8.75003 13.8791C9.12004 14.1263 9.40843 14.4777 9.57873 14.8889C9.74903 15.3 9.79358 15.7524 9.70677 16.1888C9.61995 16.6253 9.40566 17.0262 9.09099 17.3409C8.77632 17.6556 8.37541 17.8698 7.93895 17.9567C7.5025 18.0435 7.0501 17.9989 6.63896 17.8286C6.22783 17.6583 5.87643 17.3699 5.62919 16.9999C5.38196 16.6299 5.25 16.1949 5.25 15.7499C5.25 15.1532 5.48705 14.5809 5.90901 14.1589C6.33097 13.7369 6.90326 13.4999 7.5 13.4999ZM16.5 13.4999C16.945 13.4999 17.38 13.6319 17.75 13.8791C18.12 14.1263 18.4084 14.4777 18.5787 14.8889C18.749 15.3 18.7936 15.7524 18.7068 16.1888C18.62 16.6253 18.4057 17.0262 18.091 17.3409C17.7763 17.6556 17.3754 17.8698 16.939 17.9567C16.5025 18.0435 16.0501 17.9989 15.639 17.8286C15.2278 17.6583 14.8764 17.3699 14.6292 16.9999C14.382 16.6299 14.25 16.1949 14.25 15.7499C14.25 15.1532 14.4871 14.5809 14.909 14.1589C15.331 13.7369 15.9033 13.4999 16.5 13.4999Z" fill="white"/>
</svg>              <span>Department</span>
            </Link>
          )}
        </nav>

        <div className="sidebar-footer">
          <button className="btn btn-outline-light w-100" onClick={handleLogout}>
          <svg
              className="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M15.75 9V5.25C15.75 4.00736 14.7426 3 13.5 3L7.5 3C6.25736 3 5.25 4.00736 5.25 5.25L5.25 18.75C5.25 19.9926 6.25736 21 7.5 21H13.5C14.7426 21 15.75 19.9926 15.75 18.75V15M18.75 15L21.75 12M21.75 12L18.75 9M21.75 12L9 12"
                stroke="white"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>            <span>Log Out</span>
          </button>
        </div>
      </div>

      {/* Logout Confirmation Modal */}
      {showLogoutModal && (
        <div className="budget-modal">
          <div className="modal-backdrop show"></div>
          <div className="modal budget-list-modal show d-block">
            <div className="modal-dialog modal-dialog-centered">
              <div className="modal-content">
                <div className="modal-body text-center p-4">
                  <div className="modal-pic-approve mb-2">
                    <div className="approve-icon">
                    <svg
              className="svg-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M15.75 9V5.25C15.75 4.00736 14.7426 3 13.5 3L7.5 3C6.25736 3 5.25 4.00736 5.25 5.25L5.25 18.75C5.25 19.9926 6.25736 21 7.5 21H13.5C14.7426 21 15.75 19.9926 15.75 18.75V15M18.75 15L21.75 12M21.75 12L18.75 9M21.75 12L9 12"
                stroke="white"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>                    </div>
                  </div>
                  <h3 className="mb-2">Log Out?</h3>
                  <p className="text-muted">
                    Are you sure you want to log out from your account?
                  </p>
                  <div className="d-flex justify-content-center gap-4 mt-2">
                    <button
                      className="btn btn-light"
                      onClick={() => setShowLogoutModal(false)}
                    >
                      Cancel
                    </button>
                    <button className="btn btn-send" onClick={confirmLogout}>
                      Logout
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}
    </>
  );
};

export default Sidebar;